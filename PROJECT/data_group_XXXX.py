data_group = [{'customer': 'LGP', 'type': '908', 'material_no': 'LGP908-210661BLF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0212188692', 'item': '000011', 'qty': 1.0, 'workweek': '2024-32', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 0.0}
,{'customer': 'LGP', 'type': '908', 'material_no': 'LGP908-210661BLF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0212188692', 'item': '000012', 'qty': 1.0, 'workweek': '2024-32', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 0.0}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210661BLF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210662LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210663LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210664LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066101LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066102LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066103LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066104LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066105LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '01R', 'material_no': 'LGP01R-210661BLF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0}
,{'customer': 'LGP', 'type': '908', 'material_no': 'LGP908-210661CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0212188692', 'item': '000011', 'qty': 1.0, 'workweek': '2024-32', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 0.0}
,{'customer': 'LGP', 'type': '908', 'material_no': 'LGP908-210661CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0212188692', 'item': '000012', 'qty': 1.0, 'workweek': '2024-32', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 0.0}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210661CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'M', 'plant': 'SVI2', 'seq_no': 1.1}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066102LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'E', 'plant': 'SVI2', 'seq_no': 1.2}
,{'customer': 'LGP', 'type': '01R', 'material_no': 'LGP01R-210661CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'E', 'plant': 'SVI2', 'seq_no': 1.3}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066103LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 2.0}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066105CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 3.0}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066101LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 4.0}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210662LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 5.0}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210663LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 6.0}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210664LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 7.0}]

data_group_out_data = [{'customer': 'LGP', 'type': '908', 'material_no': 'LGP908-210661BLF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0212188692', 'item': '000011', 'qty': 1.0, 'workweek': '2024-32', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 0.0,'match_row':'1','order_row':'1','item_row':'1'}
,{'customer': 'LGP', 'type': '908', 'material_no': 'LGP908-210661BLF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0212188692', 'item': '000012', 'qty': 1.0, 'workweek': '2024-32', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 0.0,'match_row':'2','order_row':'1','item_row':'2'}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210661BLF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'2','item_row':'3'}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210662LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'3','item_row':'4'}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210663LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'4','item_row':'5'}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210664LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'5','item_row':'6'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066101LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'6','item_row':'7'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066102LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'7','item_row':'8'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066103LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'8','item_row':'9'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066104LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'9','item_row':'10'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066105LF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'10','item_row':'11'}
,{'customer': 'LGP', 'type': '01R', 'material_no': 'LGP01R-210661BLF', 'fg_material_no': 'LGP908-210661BLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 0, 'm_group': 'X', 'plant': 'SVI2', 'seq_no': 999.0,'match_row':'1','order_row':'11','item_row':'12'}
,{'customer': 'LGP', 'type': '908', 'material_no': 'LGP908-210661CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0212188692', 'item': '000011', 'qty': 1.0, 'workweek': '2024-32', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 0.0,'match_row':'1','order_row':'1','item_row':'1'}
,{'customer': 'LGP', 'type': '908', 'material_no': 'LGP908-210661CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0212188692', 'item': '000012', 'qty': 1.0, 'workweek': '2024-32', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 0.0,'match_row':'2','order_row':'1','item_row':'2'}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210661CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'M', 'plant': 'SVI2', 'seq_no': 1.1,'match_row':'1','order_row':'2','item_row':'3'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066102LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'E', 'plant': 'SVI2', 'seq_no': 1.2,'match_row':'1','order_row':'3','item_row':'4'}
,{'customer': 'LGP', 'type': '01R', 'material_no': 'LGP01R-210661CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'E', 'plant': 'SVI2', 'seq_no': 1.3,'match_row':'1','order_row':'4','item_row':'5'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066103LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 2.0,'match_row':'1','order_row':'5','item_row':'6'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066105CLF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 3.0,'match_row':'1','order_row':'6','item_row':'7'}
,{'customer': 'LGP', 'type': '01P', 'material_no': 'LGP01P-21066101LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 4.0,'match_row':'1','order_row':'7','item_row':'8'}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210662LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 5.0,'match_row':'1','order_row':'8','item_row':'9'}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210663LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 6.0,'match_row':'1','order_row':'9','item_row':'10'}
,{'customer': 'LGP', 'type': '01E', 'material_no': 'LGP01E-210664LF', 'fg_material_no': 'LGP908-210661CLF', 'so': '0', 'item': '0', 'qty': 0.0, 'workweek': '0', 'status': 10, 'm_group': 'F', 'plant': 'SVI2', 'seq_no': 7.0,'match_row':'1','order_row':'10','item_row':'11'}]



# groups = {}
# for item in data_group:
#     key = item['fg_material_no']
#     if key not in groups:
#         groups[key] = {'details': []}
#     groups[key]['details'].append(item)

# for key, value in groups.items():
#     sorted_details = sorted(
#         value['details'],
#         key=lambda x: (x['material_no'] != x['fg_material_no'], x['seq_no'] if x['seq_no'] is not None else float('inf'))
#     )
#     item_row = 0
#     order_row = 0
#     match_row = 0
#     data_temp = {
#         'material_no': '',
#         'fg_material_no': '',
#     }
#     for i, detail in enumerate(sorted_details):
#         if (data_temp['material_no'] == detail['material_no'] and 
#             data_temp['fg_material_no'] == detail['fg_material_no']):
#             match_row += 1
#             detail['match_row'] = match_row
#             detail['order_row'] = order_row
            
#         else:
#             order_row += 1
#             match_row = 1
#             detail['match_row'] = match_row  
#             detail['order_row'] = order_row
#             data_temp['material_no'] = detail['material_no']
#             data_temp['fg_material_no'] = detail['fg_material_no']
#         item_row += 1
#         detail['item_row'] = item_row
        
#     print(detail)
    


def process_data_none_dic(data):
    groups = {}
    for item in data_group:
        key = item['fg_material_no']
        if key not in groups:
            groups[key] = {'details': []}
        groups[key]['details'].append(item)

    result = []
    for key, value in groups.items():
        details = value['details']
        item_row = 0
        order_row = 0
        match_row = 0
        data_temp = {
            'material_no': '',
            'fg_material_no': '',
        }
        for i, detail in enumerate(details):
            if (data_temp['material_no'] == detail['material_no'] and 
                data_temp['fg_material_no'] == detail['fg_material_no']):
                match_row += 1
                detail['match_row'] = match_row
                detail['order_row'] = order_row
                
            else:
                order_row += 1
                match_row = 1
                detail['match_row'] = match_row  
                detail['order_row'] = order_row
                data_temp['material_no'] = detail['material_no']
                data_temp['fg_material_no'] = detail['fg_material_no']
            
            item_row += 1
            detail['item_row'] = item_row
            
            # Print or perform other operations with `detail`
            # print(detail)
            result.append(detail)
    return result

data = process_data_none_dic(data_group)
# print(process_data_none_dic(data_group))
for x in data:
    print(x)


